client.entry%>%select(-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`)%>%summarise_all(min())
client.entry%>%select(-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`)%>%summarise_all(s=min())
client.entry%>%select(-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`)%>%summarise_all(s=n()
)
client.entry%>%select(-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`,-`Time Difference`)%>%distinct()
client.entry%>%select(-`Entry_age`,Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`,-`Time Difference`)%>%distinct()
client.entry%>%select(-`Entry_age`,-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`)%>%group_by(`Client ID`,-`Time Difference`)%>%distinct()
client.entry%>%select(-`Entry_age`,-`Entry Date`,-`Exit Date`,-`Entry Month`,-`Entry Year`,-`EE UID`,-`Time Difference`)%>%group_by(`Client ID`,)%>%distinct()
client.entry%>%group_by(`Client ID`)%>%summarise(visit = mean(Visit_time),duration = mean(`Time Difference`))%>%
ggplot(aes(x = visit, y = duration))+geom_point(size = 1.5)+labs(x="visit times",y="duration",title = "Scatterplot of Average Duration")
p1 = client.entry %>%drop_na("Time Difference")%>%group_by(`Client ID`)%>%
summarise(td = mean(`Time Difference`),age = min(Entry_age), visit = mean(Visit_time))%>%arrange(age)%>%mutate(index = 1:2311)
ggplot(p1,aes(x=index,y=td))+geom_bar(size = 1.5,alpha = 1,stat="identity")+
labs(x = "Client Sorted by the year of first time entry",y= "Average Time Difference",title ="Distribution of Staying time")+ylim(c(0,500))
ggplot(p1,aes(x= td, fill =age))+geom_histogram(bins = 80)+xlim(c(0,500))+labs(x="Time Length",title="Distribution of Staying Time at shelter")+theme_bw()
client.entry%>%arrange(desc(`Time Difference`))
client.entry%>%select(`Time Difference`)%>%arrange(desc(`Time Difference`))
ggplot(p1,aes(x= visit))+geom_histogram(bins = 30)+labs(x="Visit times",title="Distribution of Visit times at shelter")+theme_bw()
client.entry%>%group_by(`Client ID`)%>%summarise(visit = mean(Visit_time),duration = mean(`Time Difference`))%>%
ggplot(aes(x = visit, y = duration))+geom_point(size = 1.5)+labs(x="visit times",y="duration",title = "Scatterplot of Average Duration")
summary(client.entry)
client.entry%>%drop_na(healins)%>%filter(healins < 50)%>%ggplot(aes(x =Entry_age,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Age",y = "insurance",title = "correlation between age and insurance")
client.entry%>%ggplot(aes(x =Entry_age,y = income_month))+geom_bar(stat = "identity")+theme_bw()+labs(x="monthly income",title = "correlation between age and income")
client.entry%>%ggplot(aes(x =Entry_age,y = income_month))+geom_point()+geom_smooth()
client.entry%>%ggplot(aes(x =Entry_age,y = income_month))+geom_point()+geom_smooth()+theme_bw()+labs(y="monthly income",x ="entry age",title = "correlation between age and income")
client.entry%>%drop_na(healins,income_month)%>%filter(healins < 50)%>%ggplot(aes(x =income_month,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "insurance",title = "correlation between Income and insurance")
View(client.exit)
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)$>$drop_na()
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%drop_na()
s1=data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%drop_na()
colMeans(s1)
t.test(s1[,1],s1[,2],paired= TRUE)
t.test(s1[,1]-s1[,2])
t.test(client.entry$`Disability count`,client.exit$`Disability count`,paired= TRUE)
t.test(client.entry$`Disability count`,client.exit$`Disability count`,paired= TRUE,var.equal = FALSE)
client.entry%>%drop_na(income_month)%>%ggplot(aes(y=income_month, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%drop_na(income_month)%>%ggplot(aes(x=race,y=income_month,fill=race))+geom_boxplot()
client.entry%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, group = `Client Gender`))+geom_histogram(stat = "identity", position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(x=`Time Difference`, group = `Client Gender`))+geom_histogram(stat = "identity", position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(x=`Time Difference`, group = `Client Gender`))+geom_histogram(bins = 30, position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(x=`Time Difference`, group = `Client Gender`,fill = `Client Genderer`))+geom_histogram(bins = 30, position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(x=`Time Difference`, group = `Client Gender`,fill = `Client Gender`))+geom_histogram(bins = 30, position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(x=`Time Difference`, group = `Client Gender`,fill = `Client Gender`))+geom_histogram(bins = 20, position = "dodge")
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()
help("scale_x_discrete")
table(client.entry$`Client Gender`)
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(limits = c("Female","Male","Trans Female (MTF or Male to Female)"),name = c("female","male","trans"))
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(limits = c("female","male","trans"))
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(name = c("female","male","trans"),limits = c("Female","Male","Trans Female (MTF or Male to Female)"))
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(breaks = c("female","male","trans"),limits = c("Female","Male","Trans Female (MTF or Male to Female)"))
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(labels = c("female","male","trans"),limits = c("Female","Male","Trans Female (MTF or Male to Female)"))
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(labels = c("female","male","trans"),limits = c("Female","Male","Trans Female (MTF or Male to Female)"))+guides(fill=F)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%ggplot(aes(y=`Time Difference`, x = race,fill = race))+geom_boxplot()+scale_x_discrete(labels = c("black","white","native"),limits = c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))+guides(fill=F)+labs(x="Race",y="Duration",title = "Correlation between time length and race")
library(corrplot)
cordat = as.data.frame(client.entry%>%select(`Time Difference`,income_month,healins,Entry_age,`Disability count`,`Receiving Benefit (Entry)`)%>%drop_na(`Time Difference`,income_month,healins,Entry_age,`Disability count`,`Receiving Benefit (Entry)`))
A = cor(cordat)
corrplot(A)
A
corrplot(A,addCoef.col="grey")
client.entry%>%ggplot(aes(y=`Time Difference`, x = homelesstime ,fill = homelesstime ))+geom_boxplot()+labs(x="Gender",y="Duration",title = "Correlation between time length and gender")
table(client.entry$homelesstime)
client.entry%>%drop_na(homelesstime)%>%ggplot(aes(y=`Time Difference`, x = homelesstime ,fill = homelesstime ))+geom_boxplot()+scale_x_discrete(labels = c("7-12",">12","1-6"),limits = c("between seven and twelve months","More than 12 months (HUD)","no more than six months"))+
guides(fill=F)+labs(x="Timeless time",y="Duration",title = "Correlation between time length and timeless time")
client.entry%>%filter(income_month < 25000)%>%drop_na(`Receiving Benefit (Entry)`,income_month)%>%ggplot(aes(y =income_month,x = `Receiving Benefit (Entry)`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "Disability count",title = "correlation between Disability count and Income")
client.entry%>%drop_na(healins)%>%filter(healins < 50)%>%ggplot(aes(x =Entry_age,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Age",y = "insurance",title = "correlation between age and insurance")
t.test(client.entry$income_month-client.exit$income_month_exit)
data.frame(client.entry$income_month,client.exit$income_month_exit)
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%ggplot()+geom_histogram(aes(x=client.entry.income_month),bins=30)+geom_histogram(aes(x=client.exit.income_month_exit),bins=30)
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%ggplot()+geom_histogram(aes(x=client.entry.income_month),bins=30,col="blue")+geom_histogram(aes(x=client.exit.income_month_exit),bins=30,col="red")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%ggplot()+geom_histogram(aes(x=client.entry.income_month),bins=30,fill="blue")+geom_histogram(aes(x=client.exit.income_month_exit),bins=30,fill="red")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group", value = "income")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group", value = "income")%>%ggplot(aes(x=income,fill = value,group = value))+geom_histogram(bins =30, position="dodge")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group", value = "income")%>%ggplot(aes(x=income,fill = income,group = income))+geom_histogram(bins =30, position="dodge")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group", value = "income")%>%ggplot(aes(x=income,fill = income,group = income))+geom_histogram( position="dodge")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group1", value = "income")%>%ggplot(aes(x=income,fill = group1,group = group1))+geom_histogram(bins = 50,position="dodge")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group1", value = "income")%>%ggplot(aes(x=income,fill = group1,group = group1))+geom_histogram(bins = 30,position="dodge")
data.frame(client.entry$healins,client.exit$healins_exit)%>%gather(client.entry.healins,client.exit.healins_exit,key = "health_insurance", value = "insurance")%>%ggplot(aes(x=insurance,fill = health_insurance,group = health_insurance))+geom_histogram(bins = 30,position="dodge")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count,client.exit..Disability.count,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")
help("scale_color_discrete")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(breaks = c("entry","exit"))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(labels = c("entry","exit"),limits = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(breaks = c("entry","exit"),limits = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(label = c("entry","exit"),limits = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(label = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(labels = c("entry","exit"))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_discrete(values = c("entry","exit"),limits = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_manual(values = c("entry","exit"),limits = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_color_manual(labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_fill_manual(labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+scale_fill_manual(values=c("red","blue"),labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%ggplot(aes(x=`Entry Month`,y = money))+geom_line()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%ggplot(aes(x=`Entry Month`,y = money))+geom_boxplot()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%ggplot(aes(x=`Entry Month`,y = money,group=month`))+geom_boxplot()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
`
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%ggplot(aes(x=`Entry Month`,y = money,group=`Entry month`))+geom_boxplot()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%ggplot(aes(x=`Entry Month`,y = money,group=`Entry Month`))+geom_boxplot()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%drop_na(income_month)%>%ggplot(aes(x=`Entry Month`,y = income_month,group=`Entry Month`))+geom_boxplot()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%ggplot(aes(x=`Entry Month`))+geom_histogram()
client.entry%>%ggplot(aes(x=`Entry Month`))+geom_histogram(bins = 50)
client.entry%>%ggplot(aes(x=`Entry Month`))+geom_histogram(bins = 20)
client.entry%>%ggplot(aes(x=`Entry Month`))+geom_histogram(bins = 30)
client.entry%>%group_by(`Entry Month`)%>%summarise(count = n())%>%ggplot(aes(x=`Entry Month`,y = count))+geom_line(size=1.5)
client.entry%>%group_by(`Entry Month`)%>%summarise(times = n())%>%ggplot(aes(x=`Entry Month`,y = times))+geom_line(size=1.5)+labs(title = "Visit frequency changed by months")
client.entry%>%group_by(`Entry Month`)%>%summarise(times = n())%>%ggplot(aes(x=`Entry Month`,y = times))+geom_line(size=1.5)+labs(title = "Visit frequency changed by months")+theme_bw()
client.entry%>%group_by(`Entry Month`)%>%summarise(times = n())%>%ggplot(aes(x=`Entry Month`,y = times))+geom_line(size=1.5)+labs(title = "Visit frequency changed by months")+theme_bw()+scale_x_continuous(breaks = seq(0,12,3))
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)"),`Client Gender` %in% c("Female","Male"))%>%drop_na(income_month)%>% ggplot(aes(x=income_month,fill = race))+
geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry%>%
ggplot(aes(y=`Time Difference`, x = `Client Veteran Status`,fill = `Client Veteran Status`))+geom_boxplot()
+labs(x="Race",y="Duration",title = "Correlation between time length and race")
table(client.entry$`Client Veteran Status`)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(y=`Time Difference`, x = race,fill = race))+geom_boxplot()+scale_x_discrete(labels = c("black","white","native"),limits = c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))+
guides(fill=F)+labs(x="Race",y="Duration",title = "Correlation between time length and race")
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30)+facet_wrap(~race)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30)+facet_wrap(~race,fill=race)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,fill=race)+facet_wrap(~race)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=race))+facet_wrap(~race)
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=race))+facet_wrap(~race)+guides(fill=F)
client.entry%>%drop_na(`Client Gender`)%>%ggplot(aes(y=`Time Difference`, x = `Client Gender`,fill = `Client Gender`))+geom_boxplot()+scale_x_discrete(labels = c("female","male","trans"),limits = c("Female","Male","Trans Female (MTF or Male to Female)"))+guides(fill=F)
help(facet_wrap)
client.entry%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Race",y="Duration",title = "Duration Distribution under different race")
client.entry%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry%>%drop_na(homelesstime)%>%ggplot(aes(y=`Time Difference`, x = homelesstime ,fill = homelesstime ))+geom_boxplot()+scale_x_discrete(labels = c("7-12 months",">12 months","1-6 months"),limits = c("between seven and twelve months","More than 12 months (HUD)","no more than six months"))+
guides(fill=F)+labs(x="Timeless time",y="Duration",title = "Correlation between time length and timeless time")
setwd("~/GitHub/bios611-projects-fall-2019-lcw68/project_3/scripts")
client.entry = read_tsv("client_total_entry.tsv")
client.entry = client.entry%>%select(-X1)
client.exit = read_tsv("client_total_exit.tsv")
client.exit = client.exit%>%select(-X1)
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime)
client.entry
View(client.entry)
setwd("~/GitHub/bios611-projects-fall-2019-lcw68/project_3/scripts")
client.entry = read_tsv("client_total_entry.tsv")
client.entry = client.entry%>%select(-X1)
client.exit = read_tsv("client_total_exit.tsv")
client.exit = client.exit%>%select(-X1)
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime)
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime)+annotation("good")
help("annotation")
??annotation
help(annotate)
p <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
p + annotate("text", x = 4, y = 25, label = "Some text")
p + annotate("text", x = 2:5, y = 25, label = "Some text")
p + annotate("segment", x = 2.5, xend = 4, y = 15, yend = 25,
colour = "blue")
p + annotate("text", x = 2:3, y = 20:21, label = c("my label", "label 2"))
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+    coord_flip()
+labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+coord_flip()+labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+ylim(c(0,750))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+coord_flip()+labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+xlim(c(0,750))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+coord_flip()+labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=race))+facet_grid(.~race)+guides(fill=F)+coord_flip()+labs(x="Race",y="Duration",title = "Duration Distribution under different race")
client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=30,aes(fill=race))+facet_grid(.~race)+guides(fill=F)+coord_flip()+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry%>%select(`Client Gender`,race,`Client Ethnicity`)
client.entry%>%select(`Client Gender`,race,`Client Ethnicity`,homelesstime)
table(client.entry%>%select(`Client Gender`,race,`Client Ethnicity`,homelesstime))
table(client.entry%>%select(`Client Ethnicity`,homelesstime))
table(client.entry%>%select(race,homelesstime))
client.entry = read_tsv("client_total_entry.tsv")
client.entry = client.entry%>%select(-X1)
table(client.entry%>%select(race,homelesstime))
table(client.entry%>%select(`Client Ethnicity`,homelesstime))
dat1 = table(client.entry%>%select(`Client Ethnicity`,homelesstime))
is.data.frame(dat1)
is.matrix(dat1)
chisq.test(dat1)
View(client.entry)
dat2 = table(client.entry%>%select(race,homelesstime))
dat2
chisq.test(dat2)
dat2[3,]
dat2
dat2[-c(2,4),]
chisq.test(dat2[-c(2,4),])
table(client.entry%>%select(`Client Ethnicity`,race))
table(client.entry%>%select(race,`Client Ethnicity`))[-c(2,4),]
chisq.test(table(client.entry%>%select(race,`Client Ethnicity`))[-c(2,4),])
#Construct the model
dt = client.entry%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"),`Client Gender`%in% c("Male","Female"))
dt
mod1 =lm(`Time Difference`~ Entry_age+`Client Gender`+race+`Client Veteran Status`+`Client Ethnicity`+income_month+healins+`Disability count`+`Receiving Benefit (Entry)`+homelesstime,data =dt)
summary(mod1)
vif(mod1)
plot(mod1)
mod2 =lm(`Time Difference`~ Entry_age+`Client Gender`+`Client Veteran Status`+`Client Ethnicity`+income_month+`Disability count`+homelesstime,data =dt)
summary(mod2)
step(mod1)
par(mfrow=c(2,2))
plot(mod1)
plot(mod2)
mod2 =lm(`Time Difference`~ Entry_age+`Client Gender`+`Client Veteran Status`+`Client Ethnicity`+`Disability count`+homelesstime,data =dt)
summary(mod2)
predict(mod2)
plot(client.entry$`Time Difference`,predict(mod2))
length(predict(mod2))
dt%>%select(Entry_age,`Time Difference`,Client Gender`,`Client Veteran Status`,`Client Ethnicity`,`Disability count`,homelesstime)%>%drop_na()
dt%>%select(Entry_age,`Time Difference`,`Client Gender`,`Client Veteran Status`,`Client Ethnicity`,`Disability count`,homelesstime)%>%drop_na()
A1=dt%>%select(Entry_age,`Time Difference`,`Client Gender`,`Client Veteran Status`,`Client Ethnicity`,`Disability count`,homelesstime)%>%drop_na()
plot(A1$`Time Difference`,predict(mod2))
par(mfrow=c(1,1))
plot(A1$`Time Difference`,predict(mod2))
data.frame(A1$`Time Difference`,predict(mod2))
mod2 =lm(`Time Difference`~ Entry_age+`Client Gender`+`Client Veteran Status`+`Client Ethnicity`+`Disability count`+homelesstime,data =A1)
plot(A1$`Time Difference`,predict(mod2))
summary(mod2)
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+xlim(c(0,750))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+coord_flip()+
labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry%>%drop_na(homelesstime)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=homelesstime))+xlim(c(0,750))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+
labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
summary(mod1)
client.entry%>%drop_na(`Disability count`)%>%
ggplot(aes(x = `Disability count`,y=`Time Difference`))+geom_point()
client.entry%>%drop_na(`Disability count`)%>%
ggplot(aes(x = `Disability count`,y=`Time Difference`))+geom_point()+geom_smooth()
data.frame(client.entry$`Receiving Benefit (Entry)`,client.exit$`Receiving Benefit (Exit)`)
bene = data.frame(client.entry$`Receiving Benefit (Entry)`,client.exit$`Receiving Benefit (Exit)`)
drop_na(bene)
t.test(bene[,1]-bene[,2])
colMean(bene)
colMeans(bene)
colMeans(drop_na(bene))
setwd("~/GitHub/bios611-projects-fall-2019-lcw68/project_3/data")
client.demo = read_tsv("client_demographic.tsv")
client.demo = client.demo[,-1]
View(client.demo)
client.entry%>%group_by(`Clien ID`)%>% summarise(duration = mean(`Time Difference`))
client.entry%>%group_by(`Client ID`)%>% summarise(duration = mean(`Time Difference`))
client.entry%>%group_by(`Client ID`)%>% summarise(duration = mean(`Time Difference`),dis = min(`Disability count`))
client.entry%>%group_by(`Client ID`)%>% summarise(duration = mean(`Time Difference`),dis = min(`Disability count`))%>%ggplot(aes(x=dis,y=duration))+geom_point(size=1)
client.entry%>%group_by(`Client ID`)%>% summarise(duration = mean(`Time Difference`),dis = min(`Disability count`))%>%ggplot(aes(x=dis,y=duration))+geom_point(size=1.5)
View(client.demo)
client.demo%>%left_join(client.entry%>%group_by(`Client ID`)%>% summarise(duration = mean(`Time Difference`)),by = "Client ID")
client_entry.new = client.demo%>%left_join(client.entry%>%group_by(`Client ID`)%>% summarise(duration.ave = mean(`Time Difference`)),by = "Client ID")
View(client_entry.new)
sum(is.na(client_entry.new$duration.ave))
client.entry%>%filter(`Client ID` == 463114)
client.entry%>%filter(`Client ID` == 463114)%>%mean(`Time Difference`)
client.entry%>%filter(`Client ID` == 463114)%>%select(`Time Difference`)
client_entry.new = client.demo%>%left_join(client.entry%>%drop_na(`Time Difference`)%>%group_by(`Client ID`)%>% summarise(duration.ave = mean(`Time Difference`)),by = "Client ID")
View(client_entry)
client.entry.new = client.demo%>%left_join(client.entry%>%drop_na(`Time Difference`)%>%group_by(`Client ID`)%>% summarise(duration.ave = mean(`Time Difference`)),by = "Client ID")
View(client.entry.new)
sum(is.na(client.entry.new$duration.ave))
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=`Time Difference`))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=30,aes(fill=race))+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%drop_na(`Disability count`)%>%
ggplot(aes(x = `Disability count`,y=duration.ave))+geom_point(size = 1)+geom_smooth()
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=50,aes(fill=homelesstime))+xlim(c(0,750))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+
labs(x="Duration",y="Count",title = "Duration Distribution under different homeless time")
client.entry.new%>%drop_na(income_month)%>%filter(`Client Gender` %in% c("Female","Male"))%>%ggplot(aes(x=income_month,fill = `Client Gender`))+geom_histogram(bins = 30,position = "dodge")+
labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)"),`Client Gender` %in% c("Female","Male"))%>%drop_na(income_month)%>% ggplot(aes(x=income_month,fill = race))+
geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry%>%drop_na(healins)%>%filter(healins < 50)%>%ggplot(aes(x =healins,fill = `Client Gender`))+
geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "health insurance",y = "Frequency",title = "Insurance Distribution")
client.entry%>%filter(`Client ID`==373323)
client.entry%>%filter(`Client ID`==373323)%>%select(healins)
client.entry%>%filter(`Client ID`==373323)%>%select(income_month)
client.entry%>%drop_na(healins,income_month)%>%filter(healins < 50)%>%ggplot(aes(x =income_month,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "insurance",title = "correlation between Income and insurance")
client.entry.new%>%drop_na(healins,income_month)%>%filter(healins < 50)%>%ggplot(aes(x =income_month,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "insurance",title = "correlation between Income and insurance")
dat1 = table(client.entry.new%>%select(`Client Ethnicity`,homelesstime))
chisq.test(dat1)
dat1
table(client.entry%>%select(`Client Ethnicity`,homelesstime))
chisq.test(dat1)
dat1 = table(client.entry.new%>%select(`Client Ethnicity`,homelesstime))[-(1:3),]
dat1
chisq.test(dat1)
dat2 = table(client.entry.new%>%select(race,homelesstime))
chisq.test(dat2[-c(2,4),])
dat2
dat3 = table(client.entry.new%>%select(`Client Gender`,homelesstime))
dat3
dat3 = table(client.entry.new%>%select(`Client Gender`,homelesstime))[-3,]
chisq.test(dat3)
dat3 = table(client.entry.new%>%select(`Client Gender`,race))
chisq.test(dat3)
dat3 = table(client.entry.new%>%select(`Client Gender`,race))
dat3
dat3 = table(client.entry.new%>%select(`Client Gender`,race))[-3,-c(2,4)]
dat3
chisq.test(dat3)
client.entry%>%group_by(`Entry Month`)%>%summarise(times = n())%>%ggplot(aes(x=`Entry Month`,y = times))+geom_line(size=1.5)+labs(title = "Visit frequency changed by months")+theme_bw()+scale_x_continuous(breaks = seq(0,12,3))
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%
ggplot(aes(x=`Entry Month`,y = money))+geom_line()+
labs(x="month",y="item",title = "Income change by entry month")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group1", value = "income")%>%ggplot(aes(x=income,fill = group1,group = group1))+geom_histogram(bins = 30,position="dodge")
client.entry = read_tsv("../data/client_total_entry.tsv")
client.demo
View(client.entry)
client.entry = read_tsv("../data/client_total_entry.tsv")
client.entry = client.entry%>%select(-X1)
c
View(client.entry)
dat1 = table(client.entry.new%>%select(`Client Ethnicity`,homelesstime))[-(1:3),]
dat1
chisq.test(dat1)
dat1+1
chisq.test(dat1+1)
client.entry.new
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=30,aes(fill=race))+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
# For the race variable, we have more black people than white people.
ks.test(client.entry.new%>%filter(race == "Black or African American (HUD)")%>%select(duration.ave),client.entry.new%>%filter(race == "White (HUD)")%>%select(duration.ave)
)
client.entry.new%>%filter(race == "Black or African American (HUD)")%>%select(duration.ave)
k1=as.vector(client.entry.new%>%filter(race == "Black or African American (HUD)")%>%select(duration.ave))
k2=as.vector(client.entry.new%>%filter(race == "White (HUD)")%>%select(duration.ave))
ks.test(k1,k2)
k1
k1[3]
k1=as.matrix(client.entry.new%>%filter(race == "Black or African American (HUD)")%>%select(duration.ave))
k1
k2=as.matrix(client.entry.new%>%filter(race == "White (HUD)")%>%select(duration.ave))
ks.test(k1,k2)
help(geom_histogram)
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "dodge",stat="density")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "density")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "identity")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "identity")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")+
stat_density(geom = 'line',
position = 'identity')
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(position = "identity")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")+
stat_density(geom = 'line',
position = 'identity')
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=30,aes(fill=race),position="identity")+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density()+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density()+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density(adjust = 0.5)+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Count",title = "Duration Distribution under different race")
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+geom_density(alpha = 0.5)+guides(fill=F)+labs(x="Gender",y="Duration",title = "Duration Distribution under different gender")
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=homelesstime))+geom_density(adjust=0.05)+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+
labs(x="Duration",y="Density",title = "Duration Distribution under different homeless time")
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=homelesstime))+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+
labs(x="Duration",y="Density",title = "Duration Distribution under different homeless time")
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=homelesstime))+geom_density(adjust=0.05)+facet_grid(.~homelesstime,labeller = labeller(homelesstime = labels))+
labs(x="Duration",y="Density",title = "Duration Distribution under different homeless time")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density()+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different race")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density()+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different race")
client.entry.new%>%filter(`Client Ethnicity` %in% c("Non-Hispanic/Non-Latino (HUD)","Hispanic/Latino (HUD)"))%>%drop_na(income_month)%>%
ggplot(aes(x=income_month,fill = `Client Ethnicity`))+geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%
ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+
scale_fill_manual(values=c("red","blue"),labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))+ggtitle("Disability count at entry and exit")
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%
ggplot(aes(x=`Entry Month`,y = money))+geom_line()+
labs(x="month",y="item",title = "Income vs entry month: Any trend?")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
table(clien.entry%>%select(`Entry Month`,homelesstime))
table(client.entry%>%select(`Entry Month`,homelesstime))
chisq.test(table(client.entry%>%select(`Entry Month`,homelesstime)))
dat1 = table(client.entry%>%select(`Entry Month`,homelesstime))
dat1 = as.data.frame(table(client.entry%>%select(`Entry Month`,homelesstime)))
dat1
ggplot(aes(x=Entry.Month,y=Freq,group=homelesstime))+geom_line()
ggplot(aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime))
ggplot(dat1,aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime))
ggplot(dat1,aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime,col = homelesstime))
ggplot(dat1,aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime,col = homelesstime),size=1)
client.entry%>%drop_na(income_month)%>%group_by(`Entry Month`)%>%summarise(money = mean(income_month))%>%
ggplot(aes(x=`Entry Month`,y = money))+geom_line()+
labs(x="month",y="item",title = "Income vs entry month: Any trend?")+scale_x_continuous(breaks = seq(0,12,3))+theme_bw()
client.entry%>%group_by(`Entry Month`)%>%summarise(times = n())%>%ggplot(aes(x=`Entry Month`,y = times))+geom_line(size=1.5)+labs(title = "Visit frequency changed by months")+theme_bw()+scale_x_continuous(breaks = seq(0,12,3))
table(client.entry.new$`Client Ethnicity`)
table(client.entry.new$`Client Veteran Status`)
client.entry%>%ggploe(aes(x= Entry_age))+geom_histogram()
client.entry%>%ggplot(aes(x= Entry_age))+geom_histogram()
client.entry%>%ggplot(aes(x= Entry_age))+geom_histogram()+geom_density()
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram()+geom_density()
client.entry%>%ggplot(aes(x= Entry_age,y=..density..,group = `Client Gender`))+geom_histogram(aes(fill = `Client Gender`),position = "stack")+geom_density()
client.entry%>%ggplot(aes(x= Entry_age,y=..density..,group = `Client Gender`))+geom_histogram(aes(fill = `Client Gender`),position = "dodge")+geom_density()
library(tidyverse)
library(car)
library(corrplot)
client.entry = read_tsv("../data/client_total_entry.tsv")
client.entry = client.entry%>%select(-X1)
client.exit = read_tsv("../data/client_total_exit.tsv")
client.exit = client.exit%>%select(-X1)
client.demo = read_tsv("../data/client_demographic.tsv")[,-1]
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram()+geom_density()+ggtitle("Age Distribution")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram()+geom_density(bins = 20, fill = "red")+ggtitle("Age Distribution")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram(bins = 20, fill = "red")+geom_density()+ggtitle("Age Distribution")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram(bins = 20, fill = "red")+geom_density(adjust = 1)+ggtitle("Age Distribution")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram(bins = 20, fill = "red")+geom_density(adjust = 1,size=1)+ggtitle("Age Distribution")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram(bins = 20, fill = "red")+geom_density(adjust = 0.5,size=1)+ggtitle("Age Distribution")
cordat = as.data.frame(client.entry%>%select(`Time Difference`,income_month,healins,Entry_age,`Disability count`,`Receiving Benefit (Entry)`)%>%drop_na(`Time Difference`,income_month,healins,Entry_age,`Disability count`,`Receiving Benefit (Entry)`))
A = cor(cordat)
corrplot(A,addCoef.col="grey")
p1 = client.entry %>%drop_na(`Time Difference`)%>%group_by(`Client ID`)%>%
summarise(td = mean(`Time Difference`),age = min(Entry_age), visit = mean(Visit_time))%>%arrange(age)%>%mutate(index = 1:2311)
ggplot(p1,aes(x=index,y=td))+geom_bar(size = 1.5,alpha = 1,stat="identity")+
labs(x = "Client Sorted by the year of first time entry",y= "Average Time Difference",title ="Distribution of Staying time")+ylim(c(0,500))
ggplot(p1,aes(x= td))+geom_histogram(bins = 80)+xlim(c(0,500))+labs(x="Time Length",title="Distribution of Staying Time at shelter")+theme_bw()
ggplot(p1,aes(x= visit))+geom_histogram(bins = 30)+labs(x="Visit times",title="Distribution of Visit times at shelter")+theme_bw()
client.entry%>%group_by(`Client ID`)%>%summarise(visit = mean(Visit_time),duration = mean(`Time Difference`))%>%
ggplot(aes(x = visit, y = duration))+geom_point(size = 1.5)+labs(x="visit times",y="duration",title = "Scatterplot of Average Duration")
client.entry%>%ggplot(aes(x= Entry_age,y=..density..))+geom_histogram(bins = 20, fill = "red")+geom_density(adjust = 0.5,size=1)+ggtitle("Age Distribution")
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+geom_density(adjust = 0.5)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different gender")
client.entry.new%>%drop_na(income_month)%>%filter(`Client Gender` %in% c("Female","Male"))%>%ggplot(aes(x=income_month,fill = `Client Gender`))+geom_histogram(bins = 30,position = "dodge")+
labs(x = "income",y = "Frequency",title = "Income Distribution")
arrange(client.entry$`Time Difference`)
arrange(client.entry,`Time Difference`)
View(arrange(client.entry,`Time Difference`))
View(arrange(client.entry,desc(`Time Difference`)))
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)"),`Client Gender` %in% c("Female","Male"))%>%drop_na(income_month)%>% ggplot(aes(x=income_month,fill = race))+
geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)"),`Client Gender` %in% c("Female","Male"))%>%drop_na(income_month)%>% ggplot(aes(x=income_month,fill = race))+
geom_histogram(bins = 20,position = "dodge")+theme_bw()+labs(x = "income",y = "Frequency",title = "Income Distribution")
client.entry.new%>%drop_na(`Client Gender`)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=`Client Gender`))+facet_wrap(~`Client Gender`)+geom_density(adjust = 0.5)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different gender")
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=homelesstime))+geom_density(adjust=0.05)+facet_grid(.~homelesstime)+
labs(x="Duration",y="Density",title = "Duration Distribution under different homeless time")
client.entry.new%>%filter(race %in% c("Black or African American (HUD)","White (HUD)","American Indian or Alaska Native (HUD)"))%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=30,aes(fill=race),position="identity")+geom_density()+facet_grid(.~race)+guides(fill=F)+labs(x="Duration",y="Density",title = "Duration Distribution under different race")
client.entry.new%>%drop_na(healins,income_month)%>%filter(healins < 50)%>%ggplot(aes(x =income_month,y = healins))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "insurance",title = "correlation between Income and insurance")
#homelesstime vs monthly income
client.entry%>%filter(healins < 50)%>%drop_na(`Receiving Benefit (Entry)`,healins)%>%ggplot(aes(y =income_month,x = `Receiving Benefit (Entry)`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "Disability count",title = "correlation between homeless time and Income")
client.entry%>%filter(income_month < 25000)%>%drop_na(`Disability count`,income_month)%>%ggplot(aes(x =income_month,y = `Disability count`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "Disability count",title = "correlation between Disability count and Income")
#Disability amount vs monthly income
client.entry%>%filter(income_month < 25000)%>%drop_na(`Disability count`,income_month)%>%ggplot(aes(x =income_month,y = `Disability count`,col = `Client Gneder`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "Disability count",title = "correlation between Disability count and Income")
client.entry.new%>%filter(income_month < 25000)%>%drop_na(`Disability count`,income_month)%>%ggplot(aes(x =income_month,y = `Disability count`,col = `Client Gender`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "Disability count",title = "correlation between Disability count and Income")
View(client.entry)
client.entry.new%>%drop_na(healins,income_month)%>%filter(healins < 50)%>%ggplot(aes(x =income_month,y = healins,col =`Client Veteran Status`))+geom_point()+geom_smooth()+theme_bw()+labs(x="Income",y = "insurance",title = "correlation between Income and insurance")
data.frame(client.entry$income_month,client.exit$income_month_exit)%>%gather(client.entry.income_month,client.exit.income_month_exit,key = "group1", value = "income")%>%ggplot(aes(x=income,fill = group1,group = group1))+geom_histogram(bins = 30,position="dodge")+
scale_fill_manual(values=c("red","blue"),labels = c("entry","exit"),breaks = c("client.entry.income_month","client.exit.income_month"))+ggtitle("Income comparison between entry and exit")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%
ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+
scale_fill_manual(values=c("red","blue"),labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))+ggtitle("Disability count at entry and exit")
data.frame(client.entry$`Disability count`,client.exit$`Disability count`)%>%gather(client.entry..Disability.count.,client.exit..Disability.count.,key = "Disability", value = "count")%>%
ggplot(aes(x=count,fill = Disability,group = Disability))+geom_histogram(bins = 30,position="dodge")+
scale_fill_manual(values=c("red","blue"),labels = c("entry","exit"),breaks = c("client.entry..Disability.count.","client.exit..Disability.count."))+labs(x="Disability count",y="Freq",title = "Disability count at entry and exit")
summary(mod1)
summary(mod1)
summary(mod2)
client.entry%>%drop_na(income_month)%>%
ggplot(aes(x=`Entry Month`,y = money,group = `Entry Month`))+geom_boxplot()+
labs(x="month",y="income",title = "Income vs entry month: Any trend?")+scale_x_discrete(breaks = seq(0,12,3))+theme_bw()
client.entry%>%drop_na(income_month)%>%
ggplot(aes(x=`Entry Month`,y = income_month,group = `Entry Month`))+geom_boxplot()+
labs(x="month",y="income",title = "Income vs entry month: Any trend?")+scale_x_discrete(breaks = seq(0,12,3))+theme_bw()
dat1 = as.data.frame(table(client.entry%>%select(`Entry Month`,homelesstime)))
ggplot(dat1,aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime,col = homelesstime),size=1)
dat1 = as.data.frame(table(client.entry%>%select(`Entry Month`,homelesstime)))
ggplot(dat1,aes(x=Entry.Month,y=Freq))+geom_line(aes(group=homelesstime,col = homelesstime),size=1)+labs(title = "Entry Month change regarding homeless time")
client.entry%>%ggplot(aes(x=Entry_age,y = `Time Difference`))+geom_point()
client.entry%>%ggplot(aes(x=Entry_age,y = `Time Difference`))+geom_point()+geom_smooth()
client.entry.new%>%drop_na(homelesstime)%>%
ggplot(aes(x=duration.ave,y=..density..))+geom_histogram(bins=50,aes(fill=homelesstime))+geom_density(adjust=0.05)+facet_grid(.~homelesstime)+
labs(x="Duration",y="Density",title = "Duration Distribution under different homeless time")
